<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Project Chatbot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .aurora-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(ellipse at top, #1e293b, #0f172a 70%),
                        radial-gradient(ellipse at bottom, #334155, #0f172a 70%);
            animation: aurora 20s linear infinite;
        }
        @keyframes aurora {
            0% { background-position: 0% 50%, 0% 50%; }
            50% { background-position: 100% 50%, 100% 50%; }
            100% { background-position: 0% 50%, 0% 50%; }
        }
        #chat-window {
            scroll-behavior: smooth;
        }
        .chat-bubble {
            animation: pop-in 0.3s ease-out;
        }
        @keyframes pop-in {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div class="aurora-background"></div>

    <div class="container mx-auto h-screen flex flex-col p-4 relative z-10">
        <header class="text-center py-4">
            <h1 class="text-4xl font-bold mb-1" style="color: #FFD700;">AI Project Chatbot</h1>
            <p class="text-md text-gray-400">Ask me anything about the Breakout game project!</p>
        </header>

        <div class="flex-grow bg-gray-800/50 backdrop-blur-sm rounded-lg border-2 border-gray-700 flex flex-col">
            <div id="chat-window" class="flex-grow p-4 space-y-4 overflow-y-auto">
                <!-- Chat messages will be appended here -->
            </div>
            <div class="p-4 border-t-2 border-gray-700">
                <div class="flex items-center bg-gray-900 rounded-lg">
                    <input type="text" id="chat-input" placeholder="Ask a question..." class="flex-grow bg-transparent p-3 text-white focus:outline-none">
                    <button id="send-button" class="bg-yellow-500 hover:bg-yellow-400 text-gray-900 font-bold py-3 px-5 m-1 rounded-lg transition-colors">
                        Send
                    </button>
                </div>
            </div>
        </div>
        <div class="text-center mt-4">
            <a href="/index.html" class="text-gray-400 hover:text-yellow-400 transition-colors">← Back to Home</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const chatWindow = document.getElementById('chat-window');
            const chatInput = document.getElementById('chat-input');
            const sendButton = document.getElementById('send-button');

            const addMessage = (sender, text) => {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('chat-bubble', 'max-w-xl', 'p-3', 'rounded-lg');

                if (sender === 'user') {
                    messageDiv.classList.add('bg-yellow-500', 'text-gray-900', 'self-end', 'ml-auto');
                } else {
                    messageDiv.classList.add('bg-gray-700', 'text-white', 'self-start', 'mr-auto');
                }
                
                messageDiv.textContent = text;
                chatWindow.appendChild(messageDiv);
                chatWindow.scrollTop = chatWindow.scrollHeight;
            };
            
            const showTypingIndicator = () => {
                const typingDiv = document.createElement('div');
                typingDiv.id = 'typing-indicator';
                typingDiv.classList.add('chat-bubble', 'bg-gray-700', 'text-white', 'self-start', 'mr-auto', 'p-3', 'rounded-lg');
                typingDiv.innerHTML = '<span class="animate-pulse">● ● ●</span>';
                chatWindow.appendChild(typingDiv);
                chatWindow.scrollTop = chatWindow.scrollHeight;
            };

            const removeTypingIndicator = () => {
                const indicator = document.getElementById('typing-indicator');
                if (indicator) {
                    indicator.remove();
                }
            };

            const getAIResponse = async (userMessage) => {
                showTypingIndicator();

                // This is the context from our FAQ document. The AI will use this to answer questions.
                const context = `
                    You are a helpful chatbot for a website showcasing AI proof of concepts. 
                    Answer the user's questions based ONLY on the following information about the Breakout game project.
                    Keep your answers concise and friendly.

                    ---
                    CONTEXT:
                    - Development Process: The game was developed through an iterative, conversational process with a generative AI (a large language model). The project started as a request for "Pong" but pivoted to "Breakout". The process involved continuous refinement of gameplay, mobile optimization, and adding advanced features like power-ups and multiple levels.
                    - Role of Generative AI: The AI acted as a development partner, generating HTML, CSS, and JavaScript code, debugging errors, making architectural decisions (like moving to a single-canvas design), and optimizing for desktop and mobile.
                    - Objective: The goal is to clear all bricks on the screen using a ball and paddle. Players have 3 lives and advance to the next level after clearing the screen.
                    - Scoring: Each brick is worth 10 points, multiplied by a combo counter that increases with consecutive hits and resets when the ball hits the paddle. A high score is saved in the browser.
                    - Difficulty Modes: Easy (slower ball, larger paddle), Normal (standard), and Pro (faster ball, smaller paddle).
                    - Special Bricks & Power-ups (all are temporary):
                        - Silver (Armored): Requires two hits.
                        - Green (Speed Boost): Doubles speed for all balls.
                        - Yellow (Paddle Enlarge): Doubles paddle size.
                        - Blue (Ball Shrink): Shrinks all balls by 50%.
                        - Purple (Auto-Laser): Paddle auto-fires lasers that destroy bricks.
                    - Other Features: A multi-ball system (new ball every 10 bricks), confetti explosions, screen shake on power-ups, a "3, 2, 1" countdown, and a mobile-optimized control area.
                    - Challenges: Development involved fixing mobile crashes, non-functional buttons, and physics bugs, which were resolved by re-engineering the code.
                    ---
                `;

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: context + "\n\nUser Question: " + userMessage }] });
                const payload = { contents: chatHistory };
                const apiKey = "" // Leave as-is
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        throw new Error(`API request failed with status ${response.status}`);
                    }

                    const result = await response.json();
                    const aiText = result.candidates[0].content.parts[0].text;
                    
                    removeTypingIndicator();
                    addMessage('ai', aiText);

                } catch (error) {
                    removeTypingIndicator();
                    addMessage('ai', "Sorry, I'm having trouble connecting right now. Please try again later.");
                    console.error("AI Error:", error);
                }
            };

            const handleSend = () => {
                const message = chatInput.value.trim();
                if (message) {
                    addMessage('user', message);
                    chatInput.value = '';
                    getAIResponse(message);
                }
            };

            sendButton.addEventListener('click', handleSend);
            chatInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    handleSend();
                }
            });

            // Initial greeting
            addMessage('ai', "Hello! I'm an AI agent. Feel free to ask me anything about how the Breakout game was made.");
        });
    </script>
</body>
</html>
